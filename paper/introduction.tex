\section{Introduction}

The context of the Internet of Things has seen an increase in both the number and capabilities of small, low-powered, constrained devices wanting to interact with each other and the outside world, raising the question of how to conduct discovery and communication.

Ensembles of networked ``things'' interacting with dynamic applications require rich descriptive power to promote discovery across heterogeneous devices and services, which should be reflected in their communication mechanism.
They also require the ability to react to changes in the layout or configuration of devices, whether these changes are generated by the device or by a human administrator.
One of the characteristics that distinguishes the Internet of Things from prior collections of networked things is the higher number of devices in a space and the frequency with which those devices may enter or leave a space.
Applications or services may need to react to the entrance or exit of a device or user.
Discovery mechanisms that operate at discrete intervals---request-response or periodic advertisements---expect a delay proportional to the interval length.

Publish-subscribe (pub-sub) is an attractive approach because it decouples publishers from subscribers in space: communication through a well-known broker helps deal with firewalls and NATs and reduces load on popular publishers.
There are two dominant ``flavors'' of pub-sub---topic-based and content-based---that traditionally identify tradeoffs between performance and expressiveness.
In topic-based pub-sub systems, messages are published to logical channels that may be in a flat or hierarchical namespace, and subscribers identify a name or ``glob'' that matches topics.
The benefits are that matching is typically fast and message overhead is small, but the expressive power of a ``topic'' is limited.
In content-based pub-sub, subscribers specify predicates, which act as filters for incoming messages for publishers.
While this scheme has richer descriptive power, it requires larger messages and computationally intensive brokers.

We propose an alternative pub-sub mechanism, continuous query-based syndication (CQBS), in which subscriptions are defined by SQL-style queries over publisher descriptions.
Publisher descriptions contain ``metadata'' defining properties of the device, e.g.\ location, units of measure, groupings, etc.\ that describe the context and configuration of the producer.
These queries are continuously evaluated to reflect the current configuration of all publishers, enabling subscribers to always receive messages relevant to their query even as the landscape of
publishers changes.

In this paper, we present the design and implementation of a distributed CQBS broker, a message broker for service composition that uses \emph{continuous query-based syndication} to enable dynamic and contextually-aware applications and services for the Internet of Things.
The system is intended to serve as a ubiquitous message bus connecting an array of embedded, networked devices with a collection of distributed applications.
In order to be effective, the design must meet the following requirements:
\begin{itemize}
\item High Availability: IoT applications must be robust to the inevitable hardware and network failures at scale. We wish to create a system that is resilient in the face of arbitrary machine failures.
\item Scalability: Applications will want to connect across rooms, buildings or even cities, requiring a large number of ingress points. The system should be able to scale to large numbers of clients with reasonably high message rates.
\item Simple Clients: The code necessary for a client to interact with the system should be very simple, since we assume that they may be embedded devices with limited programming facilities and computational resources.
\end{itemize}

The system as described in this paper is implemented in Go and is available online as free, open-source software at \url{https://github.com/gtfierro/cs262-project}.

%%% Local Variables:
%%% mode: latex
%%% TeX-master: "paper"
%%% End:
